<div class="card animated fadeIn borderless">
	<div class="card-header">
		<h4 class="float-xs-left">Наряд-заказы</h4>
		<button *ngIf="!readOnly" type="button" class="btn btn-sm btn-outline-info float-lg-right" (click)="createWork()">
			<i class="fa fa-plus-circle"></i>
			&nbsp; Добавить наряд-заказ
		</button>
	</div>
	<div class="card-block">
		<div class="card-block" *ngIf="isEmpty">
			<h4 class="text-muted">Список пуст <a *ngIf="!readOnly" href="javascript: void(0)" (click)="createWork()">Создать наряд-заказ</a></h4>
		</div>

		<grid *ngIf="!isEmpty" #grid [dataSource]="worksDataSource" [expandableRows]="true" [tableStyleClass]="'table table-condensed table-striped table-hover table-bordered'">
			<grid-column [expander]="true" width="1%"></grid-column>
			<grid-column header="Номер" field="number" width="10%"></grid-column>
			<grid-column header="Период" width="19%">
				<template let-callOff="rowData" grid-template="body">
					<span>{{callOff['startDate']}} - {{callOff['finishDate']}}</span>
				</template>
			</grid-column>
			<grid-column header="Наименование" field="name" width="50%"></grid-column>
			<grid-column header="ФИО" field="assignee" width="20%"></grid-column>
			<grid-column *ngIf="!readOnly" width="1%">
				<template let-callOff="rowData" grid-template="body">
					<button class="btn btn-tiny" (click)="deleteWork(callOff['id'])"><i class="fa fa-trash-o"></i></button>
				</template>
			</grid-column>
			
			<template let-i="index" let-rowApi="rowApi" let-callOff="rowData" grid-template="rowexpansion">
				<call-off-order [id]="callOff['id']" [contractId]="contractId" [templateSysName]="callOffTemplateSysName" (callOfChanged)="rowApi.update($event)" (onFinish)="finish(callOff)"></call-off-order>
			</template>
		</grid>
	</div>
</div>